/* 1 */
SELECT W.WALLETID
FROM WALLET_TRANSACTIONS W, BRAND B
WHERE W.LOYALTY_PROGRMA_ID = B.LP_ID AND B.BRANDID!='B02';

/* 2 */
SELECT W.WALLETID, W.LOYALTY_PROGRAM_ID
FROM WALLET_TRANSACTIONS W
WHERE W.POINTS='0';
/* 3 */


SELECT R.REWARDID,R.REWARDNAME
FROM REWARD R
WHERE R.REWARDID IN ( SELECT LP.REWARDID
                      FROM LP_REWARDS LP
                      WHERE LP.PROGRAMID IN ( SELECT B.LP_ID
                                             FROM BRAND B
                                             WHERE B.BRANDID = 'Brand02'));
                           
/*4 */
SELECT LP.PROGRAMNAME
FROM  LOYALTYPROGRAM LP
WHERE LP.PROGRAMID IN ( SELECT L.PROGRAMID
                        FROM LP_ACTIVITY L
                        WHERE L.ACTIVITYID IN ( SELECT A.ACTIVITY_CODE
                                                FROM ACTIVITY A
                                                WHERE A.ACTIVITY_NAME = 'Refer a friend'));

/* 5 */
SELECT W.ACTIVITY_NAME, COUNT(*)
FROM  WALLET_TRANSACTIONS W
WHERE W.LOYALTY_PROGRAM_ID = (SELECT B.LP_ID FROM BRAND B WHERE B.BRANDNAME = '01')
GROUP BY W.ACTIVITY_NAME;

/* 8 */

SELECT COUNT(*)
FROM WALLET_TRANSACTIONS W
WHERE W.WALLETID = 'C003' AND W.ACTIVITY_DATE >='08/01/2021' AND W.ACTIVITY_DATE <= '09/30/2021'
AND W.LOYALTY_PROGRAM_ID = (SELECT B.LP_ID FROM BRAND B WHERE B.BRANDNAME = '02');